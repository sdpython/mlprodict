"""
@brief      test log(time=6s)
"""
import unittest
import io
from contextlib import redirect_stdout
import numpy
from pyquickhelper.pycode import ExtTestCase
from mlprodict.testing.einsum.einsum_impl_ext import (
    numpy_extended_dot, numpy_extended_dot_python,
    numpy_extended_dot_matrix, numpy_diagonal,
    _numpy_extended_dot_equation,
    _common_check_numpy_extended_dot)


confs = [
    dict(shape1=(1, 5, 4, 1), shape2=(1, 1, 4, 6),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(1, 5, 1, 6), shape2=(1, 5, 1, 6),
         axes=(1, 3), left=(0,), right=()),
    dict(shape1=(1, 1, 1, 1), shape2=(10, 1, 1, 1),
         axes=(), left=(0,), right=(0,)),
    dict(shape1=(1, 1, 5, 4, 1), shape2=(1, 1, 1, 4, 6),
         axes=(3,), left=(0, 1, 2), right=(4,)),
    dict(shape1=(1, 1, 5, 1, 6), shape2=(1, 1, 5, 1, 6),
         axes=(2, 4), left=(0, 1), right=()),
    dict(shape1=(1, 1, 1, 1, 1), shape2=(7, 7, 1, 1, 1),
         axes=(), left=(0, 1), right=(0, 1)),
    dict(shape1=(2, 2, 2, 1), shape2=(1, 1, 2, 1),
         axes=(), left=(0, 1, 2), right=(2,)),
    dict(shape1=(2, 2, 2, 1), shape2=(1, 1, 2, 1),
         axes=(), left=(0, 1, 2), right=(2,)),
    dict(shape1=(2, 2, 2, 1), shape2=(1, 1, 2, 2),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 1, 2, 1), shape2=(1, 1, 2, 2),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 2, 2, 1), shape2=(1, 1, 2, 2),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 2, 1), shape2=(1, 1, 2, 1),
         axes=(), left=(0, 1, 2), right=(2,)),
    dict(shape1=(2, 1, 2, 1), shape2=(1, 1, 2, 2),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 1), shape2=(1, 1, 2, 2),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 2, 2, 1), shape2=(1, 1, 2, 1),
         axes=(), left=(0, 1, 2), right=(2,)),
    dict(shape1=(2, 2, 2, 1), shape2=(1, 1, 2, 2),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 1, 2, 1), shape2=(1, 1, 2, 2),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 2, 2, 1), shape2=(1, 1, 2, 2),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 2, 1), shape2=(1, 1, 2, 1),
         axes=(), left=(0, 1, 2), right=(2,)),
    dict(shape1=(2, 2, 2, 1), shape2=(1, 1, 2, 1),
         axes=(), left=(0, 1, 2), right=(2,)),
    dict(shape1=(2, 2, 2, 1), shape2=(1, 1, 2, 2),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(1, 2, 2, 1), shape2=(1, 1, 2, 2),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(2, 2, 2, 1), shape2=(1, 1, 2, 2),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 2, 1), shape2=(1, 1, 2, 1),
         axes=(), left=(0, 1, 2), right=(2,)),
    dict(shape1=(1, 2, 2, 1), shape2=(1, 1, 2, 2),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 1), shape2=(1, 1, 2, 2),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(2, 2, 2, 1), shape2=(1, 1, 2, 1),
         axes=(), left=(0, 1, 2), right=(2,)),
    dict(shape1=(2, 2, 2, 1), shape2=(1, 1, 2, 2),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(1, 2, 2, 1), shape2=(1, 1, 2, 2),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(2, 2, 2, 1), shape2=(1, 1, 2, 2),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 2, 1), shape2=(1, 1, 2, 1),
         axes=(), left=(0, 1, 2), right=(2,)),
    dict(shape1=(2, 1, 2, 1), shape2=(1, 1, 2, 2),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 1), shape2=(1, 1, 2, 2),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 1), shape2=(1, 1, 2, 2),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 1), shape2=(1, 1, 2, 2),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 1), shape2=(1, 1, 2, 2),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 1), shape2=(1, 1, 2, 2),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 1), shape2=(1, 1, 2, 2),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 1), shape2=(1, 1, 2, 2),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 1, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 1), right=(5,)),
    dict(shape1=(2, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(2, 2, 1, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 1), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(1, 2, 3), right=(3,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 1),
         axes=(), left=(0, 2, 3), right=(3,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(1, 2), right=(5,)),
    dict(shape1=(1, 2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(1, 2), right=(2, 3)),
    dict(shape1=(1, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(1, 2), right=(4,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3,), left=(0, 2), right=(5,)),
    dict(shape1=(2, 1, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 2), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 2, 2, 1),
         axes=(3,), left=(0, 2), right=(4,)),
    dict(shape1=(1, 5, 4, 1), shape2=(1, 1, 4, 6),
         axes=(2,), left=(0, 1), right=(3,)),
    dict(shape1=(1, 5, 1, 6), shape2=(1, 5, 1, 6),
         axes=(1, 3), left=(0,), right=()),
    dict(shape1=(1, 1, 1, 1), shape2=(10, 1, 1, 1),
         axes=(), left=(0,), right=(0,)),
    dict(shape1=(1, 1, 5, 4, 1), shape2=(1, 1, 1, 4, 6),
         axes=(3,), left=(0, 1, 2), right=(4,)),
    dict(shape1=(1, 1, 5, 1, 6), shape2=(1, 1, 5, 1, 6),
         axes=(2, 4), left=(0, 1), right=()),
    dict(shape1=(1, 1, 1, 1, 1), shape2=(7, 7, 1, 1, 1),
         axes=(), left=(0, 1), right=(0, 1)),
    dict(shape1=(1, 1, 1, 8, 2), shape2=(1, 2, 4, 8, 1),
         axes=(3,), left=(4,), right=(1, 2)),
    dict(shape1=(1, 2, 1, 2, 1), shape2=(
        1, 2, 1, 2, 1), axes=(1, 3), left=(), right=()),
    dict(shape1=(1, 1, 1, 1, 1), shape2=(2, 1, 2, 1, 2),
         axes=(), left=(), right=(0, 2, 4)),
    dict(shape1=(1, 1, 2, 1, 2, 2), shape2=(1, 2, 2, 2, 1, 1),
         axes=(), left=(2, 4, 5), right=(1, 2, 3)),
    dict(shape1=(1, 2, 2, 2, 2, 2), shape2=(2, 1, 2, 1, 1, 2),
         axes=(2,), left=(1, 3, 4, 5), right=(0, 5)),
    dict(shape1=(2, 2, 1, 2, 2, 2), shape2=(1, 1, 1, 2, 1, 2),
         axes=(3, 5), left=(0, 1, 4), right=()),
    dict(shape1=(2, 2, 1, 1), shape2=(2, 1, 2, 1),
         axes=(), left=(0, 1), right=(0, 2)),
    dict(shape1=(2, 2, 2, 1), shape2=(2, 1, 1, 2),
         axes=(0,), left=(1, 2), right=(3,)),
    dict(shape1=(2, 1, 2, 1), shape2=(2, 2, 1, 1),
         axes=(), left=(0, 2), right=(0, 1)),
    dict(shape1=(2, 2, 2, 1), shape2=(2, 1, 1, 2),
         axes=(0,), left=(1, 2), right=(3,)),
    dict(shape1=(1, 1, 2, 1, 1), shape2=(2, 1, 1, 1, 2),
         axes=(), left=(2,), right=(0, 4)),
    dict(shape1=(2, 1, 2, 1, 2), shape2=(2, 1, 1, 2, 1),
         axes=(), left=(0, 2, 4), right=(0, 3)),
    dict(shape1=(2, 1, 2, 2, 2), shape2=(2, 2, 2, 1, 1),
         axes=(0, 2), left=(3, 4), right=(1,)),
    dict(shape1=(1, 1, 2, 2, 1, 1), shape2=(1, 1, 2, 1, 2, 2),
         axes=(2,), left=(3,), right=(4, 5)),
    dict(shape1=(1, 1, 1, 2, 2, 2), shape2=(2, 1, 1, 1, 2, 1),
         axes=(4,), left=(3, 5), right=(0,)),
    dict(shape1=(2, 1, 1, 2, 1, 2), shape2=(1, 2, 1, 2, 1, 2),
         axes=(3, 5), left=(0,), right=(1,)),
    dict(shape1=(2, 2, 1, 1, 1, 1), shape2=(1, 1, 2, 2, 1, 1),
         axes=(), left=(0, 1), right=(2, 3)),
    dict(shape1=(2, 2, 2, 2, 1, 1), shape2=(1, 1, 1, 1, 2, 2),
         axes=(), left=(0, 1, 2, 3), right=(4, 5)),
    dict(shape1=(2, 1, 1, 1, 1, 1), shape2=(
        1, 1, 2, 2, 1, 1), axes=(), left=(0,), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2, 1, 1), shape2=(1, 1, 1, 1, 1, 2),
         axes=(), left=(0, 2, 3), right=(5,)),
    dict(shape1=(2, 2, 1, 1, 1), shape2=(1, 1, 2, 2, 1),
         axes=(), left=(0, 1), right=(2, 3)),
    dict(shape1=(2, 2, 2, 2, 1), shape2=(1, 1, 1, 2, 2),
         axes=(), left=(0, 1, 2, 3), right=(3, 4)),
    dict(shape1=(1, 2, 1, 1, 1), shape2=(
        1, 1, 1, 2, 1), axes=(), left=(1,), right=(3,)),
    dict(shape1=(1, 2, 1, 2, 1), shape2=(1, 1, 1, 2, 2),
         axes=(3,), left=(1,), right=(4,)),
    dict(shape1=(2, 2, 1, 1), shape2=(1, 2, 2, 2),
         axes=(), left=(0, 1), right=(1, 2, 3)),
    dict(shape1=(2, 2, 2, 2), shape2=(1, 1, 2, 2),
         axes=(), left=(0, 1, 2, 3), right=(2, 3)),
    dict(shape1=(2, 2, 1, 1), shape2=(1, 2, 2, 2),
         axes=(), left=(0, 1), right=(1, 2, 3)),
    dict(shape1=(2, 2, 2, 2), shape2=(1, 1, 2, 2),
         axes=(2,), left=(0, 1, 3), right=(3,)),
    dict(shape1=(2, 1, 1, 1, 2, 1, 1, 1), shape2=(
        1, 2, 1, 1, 1, 2, 1, 1), axes=(), left=(0, 4), right=(1, 5)),
    dict(shape1=(2, 2, 1, 1, 2, 2, 1, 1), shape2=(1, 1, 2, 1,
         1, 1, 2, 1), axes=(), left=(0, 1, 4, 5), right=(2, 6)),
    dict(shape1=(2, 2, 2, 1, 2, 2, 2, 1), shape2=(1, 1, 1, 2, 1, 1, 1, 2),
         axes=(), left=(0, 1, 2, 4, 5, 6), right=(3, 7)),
    dict(shape1=(2, 2, 2, 2, 2, 2, 2, 2), shape2=(2, 2, 2, 2, 1, 1, 1, 1),
         axes=(0, 1, 2, 3), left=(4, 5, 6, 7), right=()),
    dict(shape1=(2, 2, 1), shape2=(2, 2, 1), axes=(0, 1), left=(), right=()),
    dict(shape1=(1, 1, 1), shape2=(1, 1, 2), axes=(), left=(), right=(2,)),
    dict(shape1=(2, 2, 1, 1), shape2=(2, 2, 1, 1),
         axes=(1,), left=(0,), right=(0,)),
    dict(shape1=(2, 1, 1, 1), shape2=(1, 1, 2, 2),
         axes=(), left=(0,), right=(2, 3)),
    dict(shape1=(2, 1, 2, 2), shape2=(1, 1, 2, 2),
         axes=(3,), left=(0, 2), right=(2,)),
    dict(shape1=(2, 2, 1, 1), shape2=(2, 2, 1, 1),
         axes=(0, 1), left=(), right=()),
    dict(shape1=(1, 1, 1, 1), shape2=(1, 1, 2, 2),
         axes=(), left=(), right=(2, 3)),
    dict(shape1=(1, 1, 2, 2), shape2=(1, 1, 2, 2),
         axes=(), left=(2, 3), right=(2, 3)),
    dict(shape1=(2, 2, 1, 1, 1, 1), shape2=(
        2, 1, 1, 1, 1, 2), axes=(0,), left=(1,), right=(5,)),
    dict(shape1=(1, 2, 1, 1, 1, 2), shape2=(
        1, 1, 1, 2, 1, 2), axes=(5,), left=(1,), right=(3,)),
    dict(shape1=(1, 2, 1, 2, 1, 1), shape2=(
        1, 1, 1, 1, 2, 1), axes=(), left=(1, 3), right=(4,)),
    dict(shape1=(2, 1, 1), shape2=(1, 1, 1), axes=(), left=(0,), right=()),
    dict(shape1=(2, 1, 1), shape2=(2, 2, 1), axes=(0,), left=(), right=(1,)),
    dict(shape1=(2, 1, 1, 2, 2), shape2=(2, 2, 1, 1, 1),
         axes=(0,), left=(3, 4), right=(1,)),
    dict(shape1=(1, 2, 1, 2, 2), shape2=(1, 1, 2, 1, 1),
         axes=(), left=(1, 3, 4), right=(2,)),
    dict(shape1=(1, 2, 2, 2, 2), shape2=(1, 1, 2, 2, 1),
         axes=(2, 3), left=(1, 4), right=()),
    dict(shape1=(1, 2, 1), shape2=(1, 2, 1), axes=(1,), left=(), right=()),
    dict(shape1=(1, 1, 1), shape2=(1, 1, 2), axes=(), left=(), right=(2,)),
    dict(shape1=(2, 1, 1), shape2=(2, 1, 1), axes=(0,), left=(), right=()),
    dict(shape1=(1, 1, 1), shape2=(1, 1, 2), axes=(), left=(), right=(2,)),
    dict(shape1=(2, 1, 1), shape2=(2, 1, 1), axes=(0,), left=(), right=()),
    dict(shape1=(1, 1, 1), shape2=(1, 2, 1), axes=(), left=(), right=(1,)),
    dict(shape1=(2, 1, 1), shape2=(2, 1, 1), axes=(0,), left=(), right=()),
    dict(shape1=(1, 1, 1), shape2=(1, 2, 1), axes=(), left=(), right=(1,)),
    dict(shape1=(1, 2, 1), shape2=(2, 1, 1), axes=(), left=(1,), right=(0,)),
    dict(shape1=(2, 2, 1), shape2=(2, 1, 1), axes=(0,), left=(1,), right=()),
    dict(shape1=(1, 1, 2, 1), shape2=(1, 2, 1, 1),
         axes=(), left=(2,), right=(1,)),
    dict(shape1=(1, 2, 2, 1), shape2=(1, 2, 1, 1),
         axes=(1,), left=(2,), right=()),
    dict(shape1=(2, 1, 2, 1), shape2=(2, 2, 1, 1),
         axes=(0,), left=(2,), right=(1,)),
    dict(shape1=(1, 2, 2, 1), shape2=(1, 2, 1, 1),
         axes=(1,), left=(2,), right=()),
    dict(shape1=(1, 2, 1, 2, 1), shape2=(1, 2, 2, 1, 1),
         axes=(1,), left=(3,), right=(2,)),
    dict(shape1=(1, 1, 2, 2, 1), shape2=(
        1, 1, 2, 1, 1), axes=(2,), left=(3,), right=()),
    dict(shape1=(2, 2, 1, 2, 1), shape2=(1, 2, 2, 1, 1),
         axes=(1,), left=(0, 3), right=(2,)),
    dict(shape1=(2, 1, 2, 2, 1), shape2=(2, 1, 1, 1, 2),
         axes=(0,), left=(2, 3), right=(4,)),
    dict(shape1=(1, 1, 2, 2, 2), shape2=(1, 1, 2, 1, 2),
         axes=(2, 4), left=(3,), right=()),
    dict(shape1=(2, 2, 1), shape2=(1, 2, 2), axes=[1], left=[0], right=[2]),
    dict(shape1=(2, 1, 2), shape2=(1, 2, 2), axes=[2], left=[0], right=[1]),
    dict(shape1=(2, 2, 1), shape2=(1, 2, 2), axes=[2], left=[0], right=[1, 2]),
    dict(shape1=(2, 2, 1), shape2=(1, 2, 2), axes=[2], left=[0, 1], right=[2]),
    dict(shape1=(2, 2, 2), shape2=(2, 2, 2), axes=[1], left=[0], right=[2]),
    dict(shape1=(2, 2, 2), shape2=(2, 2, 2), axes=[1], left=[2], right=[0]),
    dict(shape1=(2, 2, 2), shape2=(2, 2, 2), axes=[1], left=[2], right=[0, 1]),
    dict(shape1=(2, 1, 1), shape2=(2, 2, 1), axes=(), left=(0,), right=(0, 1)),
    dict(shape1=(2, 2, 1), shape2=(2, 2, 2),
         axes=(), left=(0, 1), right=(0, 1, 2)),
    dict(shape1=(2, 1), shape2=(1, 2), axes=(), left=(0,), right=(1,)),
    dict(shape1=(2, 2), shape2=(2, 2), axes=(), left=(0, 1), right=(0, 1)),
    dict(shape1=(2, 2, 1), shape2=(1, 2, 2),
         axes=[], left=[0, 2], right=[1, 2]),
]


class TestEinsumGenericdot(ExtTestCase):

    def test_generic_dot_python(self):

        for i, conf in enumerate(confs):
            with self.subTest(i=i, total=len(confs), conf=conf):
                r = self.common_test(conf["shape1"], conf["shape2"],
                                     conf["axes"], conf["left"], conf["right"],
                                     numpy_extended_dot_python)
                if not r:
                    print(i, conf)

    def test_generic_dot_matrix(self):

        for i, conf in enumerate(confs):
            with self.subTest(i=i, total=len(confs), conf=conf):
                r = self.common_test(conf["shape1"], conf["shape2"],
                                     conf["axes"], conf["left"], conf["right"],
                                     numpy_extended_dot_matrix)
                if not r:
                    print(i, conf)

    def test_generic_dot_matrix_conf1(self):

        conf = dict(shape1=(2, 2, 1), shape2=(1, 2, 2),
                    axes=[2], left=[0], right=[1, 2])
        self.common_test(conf["shape1"], conf["shape2"],
                         conf["axes"], conf["left"], conf["right"],
                         numpy_extended_dot_python)
        self.common_test(conf["shape1"], conf["shape2"],
                         conf["axes"], conf["left"], conf["right"],
                         numpy_extended_dot_matrix,
                         verbose=False)

    def test_generic_dot_matrix_conf2(self):

        conf = dict(shape1=(2, 2, 1), shape2=(1, 2, 2),
                    axes=[], left=[0, 2], right=[1, 2])
        self.common_test(conf["shape1"], conf["shape2"],
                         conf["axes"], conf["left"], conf["right"],
                         numpy_extended_dot_python)
        self.common_test(conf["shape1"], conf["shape2"],
                         conf["axes"], conf["left"], conf["right"],
                         numpy_extended_dot_matrix,
                         verbose=False)

    def test_generic_dot_matrix_conf3(self):

        conf = dict(shape1=(2, 2, 2), shape2=(2, 2, 2),
                    axes=[2], left=[0], right=[1])
        self.common_test(conf["shape1"], conf["shape2"],
                         conf["axes"], conf["left"], conf["right"],
                         numpy_extended_dot_python)
        self.common_test(conf["shape1"], conf["shape2"],
                         conf["axes"], conf["left"], conf["right"],
                         numpy_extended_dot_matrix,
                         verbose=False)

    def test_generic_dot_matrix_conf0(self):

        conf = dict(shape1=(1, 5, 4, 1), shape2=(1, 1, 4, 6),
                    axes=(2,), left=(0, 1), right=(3,))
        self.common_test(conf["shape1"], conf["shape2"],
                         conf["axes"], conf["left"], conf["right"],
                         numpy_extended_dot_python)
        self.common_test(conf["shape1"], conf["shape2"],
                         conf["axes"], conf["left"], conf["right"],
                         numpy_extended_dot_matrix,
                         verbose=False)

    def common_test(self, sh1, sh2, axes, left, right, fct, verbose=False):

        m1 = numpy.empty(sh1).ravel()
        m1 = numpy.arange(len(m1)).reshape(sh1).astype(numpy.float64) + 10
        m2 = numpy.empty(sh2).ravel()
        m2 = numpy.arange(len(m2)).reshape(sh2).astype(numpy.float64) + 1000

        try:
            exp = numpy_extended_dot(
                m1, m2, axes, left, right, verbose=verbose)
        except ValueError:
            return False
        try:
            dot = fct(m1, m2, axes, left, right, verbose=verbose)
        except (IndexError, NotImplementedError, ValueError):
            dot = fct(m1, m2, axes, left, right, verbose=not verbose)

        try:
            self.assertEqualArray(exp, dot)
            redo = False
        except AssertionError:
            redo = True
        if not redo:
            return True

        f = io.StringIO()
        with redirect_stdout(f):
            exp = numpy_extended_dot(
                m1, m2, axes, left, right, verbose=verbose)
            dot = fct(m1, m2, axes, left, right, verbose=True)
        try:
            self.assertEqualArray(exp, dot)
        except AssertionError:
            raise AssertionError(  # pylint: disable=W0707
                "shape1=%r shape2=%r\naxes=%r left=%r right=%r\n"
                "m1=%r\nm2=%r\nexp=\n%r\ndot=\n%r"
                "\n-----\n%s" % (m1.shape, m2.shape, axes, left, right,
                                 m1.ravel(), m2.ravel(),
                                 exp.ravel(), dot.ravel(), f.getvalue()))
        return True

    def test_exc(self):
        self.assertRaise(
            lambda: numpy_diagonal(None, 6, (8, 9)),
            RuntimeError)
        self.assertRaise(
            lambda: _numpy_extended_dot_equation(4, 5, None, None, None),
            RuntimeError)
        self.assertRaise(
            lambda: _numpy_extended_dot_equation(1, 1, (4, 5), (6, 7), (8, 9)),
            ValueError)
        self.assertRaise(
            lambda: _numpy_extended_dot_equation(
                10, 10, (-4, 5), (6, 7), (8, 9)),
            ValueError)
        self.assertRaise(
            lambda: _common_check_numpy_extended_dot(
                numpy.array([5], dtype=numpy.float32),
                numpy.array([5], dtype=numpy.int64),
                None, None, None),
            TypeError)

    def test_verbose(self):
        conf = dict(shape1=(1, 5, 4, 1), shape2=(1, 1, 4, 6),
                    axes=(2,), left=(0, 1), right=(3,))
        sh1 = conf['shape1']
        sh2 = conf['shape2']
        axes = conf['axes']
        left = conf['left']
        right = conf['right']
        m1 = numpy.empty(sh1).ravel()
        m1 = numpy.arange(len(m1)).reshape(sh1).astype(numpy.float64) + 10
        m2 = numpy.empty(sh2).ravel()
        m2 = numpy.arange(len(m2)).reshape(sh2).astype(numpy.float64) + 1000
        self.capture(
            lambda: numpy_extended_dot_python(
                m1, m2, axes, left, right, verbose=True))
        self.capture(
            lambda: numpy_extended_dot_matrix(
                m1, m2, axes, left, right, verbose=True))


if __name__ == "__main__":
    unittest.main()
